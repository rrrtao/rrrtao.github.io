<!DOCTYPE html>
<html lang=zh>
<head>
  <meta charset="utf-8">
  
  <meta name="chinaz-site-verification" content="36F7235615FEBCF2">
  <meta name="baidu-site-verification" content="NoNNyIfZWn" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  <!-- Color theme for statusbar -->
  <meta name="theme-color" content="#000000" />
  <!-- 强制页面在当前窗口以独立页面显示,防止别人在框架里调用页面 -->
  <meta http-equiv="window-target" content="_top" />
  <meta name="keywords" content="互联网,程序员,项目管理,敏捷开发,微服务,系统架构,团队管理" />
  
  
  <title>VMware搭建最新k8s集群v1.18.3 | 比特笔</title>
  <meta name="description" content="环境   环境 说明    宿主机 win10（16G）   VMware 15.5.1   centOS 7 下载地址   虚拟机   环境 说明    10.0.0.128 master-k8s 4C4G   10.0.0.129 node2-k8s 4C4G   10.0.0.130 node3-k8s 4C4G    先在 master-k8s 上安装基本软件服务，然后在克隆node2-k">
<meta property="og:type" content="article">
<meta property="og:title" content="VMware搭建最新k8s集群v1.18.3">
<meta property="og:url" content="http://btbib.com/2020-06-17-1.html">
<meta property="og:site_name" content="比特笔">
<meta property="og:description" content="环境   环境 说明    宿主机 win10（16G）   VMware 15.5.1   centOS 7 下载地址   虚拟机   环境 说明    10.0.0.128 master-k8s 4C4G   10.0.0.129 node2-k8s 4C4G   10.0.0.130 node3-k8s 4C4G    先在 master-k8s 上安装基本软件服务，然后在克隆node2-k">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2020-06-17T04:37:39.000Z">
<meta property="article:modified_time" content="2020-06-17T04:45:22.175Z">
<meta property="article:author" content="比特笔">
<meta property="article:tag" content="k8s">
<meta name="twitter:card" content="summary">
  <!-- Canonical links -->
  <link rel="canonical" href="http://btbib.com/2020-06-17-1.html">
  
    <link rel="alternate" href="/atom.xml" title="比特笔" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png" type="image/x-icon">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  
  
  

  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?e41c735e2b207be80cffd4b477fca4ea";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>    
    
<meta name="generator" content="Hexo 4.2.0"></head>


<body class="main-center" itemscope itemtype="http://schema.org/WebPage">
  <header class="header" itemscope itemtype="http://schema.org/WPHeader">
  <div class="slimContent">
    <div class="navbar-header">
      
      
      <div class="profile-block text-center">
        <a id="avatar" href="" target="_blank">
          <img class="img-circle img-rotate" src="/images/avatar.jpg" width="200" height="200">
        </a>
        <h2 id="name" class="hidden-xs hidden-sm">比特笔</h2>
        <h3 id="title" class="hidden-xs hidden-sm hidden-md" ><a href="/about" title="上古码农，统治六界，降妖除魔，国泰民安，建房种树，喝茶聊码。" style="cursor:pointer;">上古码农</a></h3>
        <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> Chongqing, China</small>
      </div>
      
      <div class="search" id="search-form-wrap">

    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="搜索" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i class="icon icon-search"></i></button>
            </span>
        </div>
    </form>
    <div class="ins-search">
  <div class="ins-search-mask"></div>
  <div class="ins-search-container">
    <div class="ins-input-wrapper">
      <input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech />
      <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
    </div>
    <div class="ins-section-wrapper">
      <div class="ins-section-container"></div>
    </div>
  </div>
</div>


</div>
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
      <ul class="nav navbar-nav main-nav ">
        
        
        <li class="menu-item menu-item-home">
          <a href="/.">
            
            <i class="icon icon-home-fill"></i>
            
            <span class="menu-title">首页</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            
            <i class="icon icon-archives-fill"></i>
            
            <span class="menu-title">归档</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-categories">
          <a href="/categories">
            
            <i class="icon icon-folder"></i>
            
            <span class="menu-title">分类</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-tags">
          <a href="/tags">
            
            <i class="icon icon-tags"></i>
            
            <span class="menu-title">标签</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-repository">
          <a href="/repository">
            
            <i class="icon icon-project"></i>
            
            <span class="menu-title">项目</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-books">
          <a href="/books">
            
            <i class="icon icon-book-fill"></i>
            
            <span class="menu-title">书单</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-links">
          <a href="/links">
            
            <i class="icon icon-friendship"></i>
            
            <span class="menu-title">友链</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-about">
          <a href="/about">
            
            <i class="icon icon-cup-fill"></i>
            
            <span class="menu-title">关于</span>
          </a>
        </li>
        
      </ul>
      
	
    <ul class="social-links">
    	
        <li><a href="/atom.xml" target="_blank" title="Rss" data-toggle=tooltip data-placement=top><i class="icon icon-rss"></i></a></li>
        
    </ul>

    </nav>
  </div>
</header>

  
    <aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">公告</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content">
                <p>欢迎交流与分享经验!</p>
            </div>
        </div>
    </div>
</div>

    
      
  <div class="widget">
    <h3 class="widget-title">分类</h3>
    <div class="widget-body">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/MySQL/">MySQL</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/hexo/">hexo</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AE%B9%E5%99%A8%E4%BA%91/">容器云</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%AE%A1%E7%90%86/">管理</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%98%BF%E9%87%8C%E5%B7%B4%E5%B7%B4%E4%B8%AD%E9%97%B4%E4%BB%B6/">阿里巴巴中间件</a><span class="category-list-count">1</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">标签</h3>
    <div class="widget-body">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java%E5%90%8E%E7%AB%AF/" rel="tag">Java后端</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Leader/" rel="tag">Leader</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MySQL/" rel="tag">MySQL</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spring-Cloud/" rel="tag">Spring Cloud</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/k8s/" rel="tag">k8s</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">标签云</h3>
    <div class="widget-body tagcloud">
      <a href="/tags/Java%E5%90%8E%E7%AB%AF/" style="font-size: 13px;">Java后端</a> <a href="/tags/Leader/" style="font-size: 13px;">Leader</a> <a href="/tags/MySQL/" style="font-size: 13px;">MySQL</a> <a href="/tags/Spring-Cloud/" style="font-size: 13px;">Spring Cloud</a> <a href="/tags/k8s/" style="font-size: 13px;">k8s</a>
    </div>
  </div>

    
      
  <div class="widget">
    <h3 class="widget-title">归档</h3>
    <div class="widget-body">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">六月 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">三月 2020</a><span class="archive-list-count">3</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget-body">
      <ul class="recent-post-list list-unstyled no-thumbnail">
        
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/%E5%AE%B9%E5%99%A8%E4%BA%91/">容器云</a>
              </p>
              <p class="item-title">
                <a href="/2020-06-17-1.html" class="title">VMware搭建最新k8s集群v1.18.3</a>
              </p>
              <p class="item-date">
                <time datetime="2020-06-17T04:37:39.000Z" itemprop="datePublished">2020-06-17</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/%E7%AE%A1%E7%90%86/">管理</a>
              </p>
              <p class="item-title">
                <a href="/2020-05-11-1.html" class="title">技术Leader的30条军规</a>
              </p>
              <p class="item-date">
                <time datetime="2020-05-11T06:16:25.000Z" itemprop="datePublished">2020-05-11</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/MySQL/">MySQL</a>
              </p>
              <p class="item-title">
                <a href="/2020-03-27-3.html" class="title">MySQL数据库开发规范</a>
              </p>
              <p class="item-date">
                <time datetime="2020-03-27T00:50:26.000Z" itemprop="datePublished">2020-03-27</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/%E9%98%BF%E9%87%8C%E5%B7%B4%E5%B7%B4%E4%B8%AD%E9%97%B4%E4%BB%B6/">阿里巴巴中间件</a>
              </p>
              <p class="item-title">
                <a href="/2020-03-25-2.html" class="title">start.aliyun.com 正式上线！极速构建 Spring Cloud 应用</a>
              </p>
              <p class="item-date">
                <time datetime="2020-03-25T01:33:38.000Z" itemprop="datePublished">2020-03-25</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/hexo/">hexo</a>
              </p>
              <p class="item-title">
                <a href="/2020-03-15-1.html" class="title">Hello World</a>
              </p>
              <p class="item-date">
                <time datetime="2020-03-15T08:22:20.000Z" itemprop="datePublished">2020-03-15</time>
              </p>
            </div>
          </li>
          
      </ul>
    </div>
  </div>
  

    
  </div>
</aside>

  
  
<main class="main" role="main">
  <div class="content">
  <article id="post-VMware搭建最新k8s集群v1-18-3" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      
        
  
    <h1 class="article-title" itemprop="name">
      VMware搭建最新k8s集群v1.18.3
    </h1>
  

      
      <div class="article-meta">
        <span class="article-date">
    <i class="icon icon-calendar-check"></i>
	<a href="/2020-06-17-1.html" class="article-date">
	  <time datetime="2020-06-17T04:37:39.000Z" itemprop="datePublished">2020-06-17</time>
	</a>
</span>
        
  <span class="article-category">
    <i class="icon icon-folder"></i>
    <a class="article-category-link" href="/categories/%E5%AE%B9%E5%99%A8%E4%BA%91/">容器云</a>
  </span>

        
  <span class="article-tag">
    <i class="icon icon-tags"></i>
	<a class="article-tag-link" href="/tags/k8s/" rel="tag">k8s</a>
  </span>


        

        <span class="post-comment"><i class="icon icon-comment"></i> <a href="/2020-06-17-1.html#comments" class="article-comment-link">评论</a></span>
        
      </div>
    </div>
    <div class="article-entry marked-body" itemprop="articleBody">
      
        <h3 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h3><table>
<thead>
<tr>
<th>环境</th>
<th align="right">说明</th>
</tr>
</thead>
<tbody><tr>
<td>宿主机</td>
<td align="right">win10（16G）</td>
</tr>
<tr>
<td>VMware</td>
<td align="right">15.5.1</td>
</tr>
<tr>
<td>centOS 7</td>
<td align="right"><a href="http://mirrors.aliyun.com/centos/7/isos/x86_64/CentOS-7-x86_64-DVD-2003.iso" target="_blank" rel="noopener">下载地址</a></td>
</tr>
</tbody></table>
<h3 id="虚拟机"><a href="#虚拟机" class="headerlink" title="虚拟机"></a>虚拟机</h3><table>
<thead>
<tr>
<th>环境</th>
<th align="right">说明</th>
</tr>
</thead>
<tbody><tr>
<td>10.0.0.128</td>
<td align="right">master-k8s 4C4G</td>
</tr>
<tr>
<td>10.0.0.129</td>
<td align="right">node2-k8s 4C4G</td>
</tr>
<tr>
<td>10.0.0.130</td>
<td align="right">node3-k8s 4C4G</td>
</tr>
</tbody></table>
<blockquote>
<p>先在 master-k8s 上安装基本软件服务，然后在克隆node2-k8s,node3-k8s</p>
</blockquote>
<hr>
<p><strong>* 3台centos都要执行的步骤  [start] *</strong></p>
<h4 id="关闭防火墙"><a href="#关闭防火墙" class="headerlink" title="关闭防火墙"></a>关闭防火墙</h4><p>顺序执行命令：</p>
<ul>
<li>iptables -F</li>
<li>setenforce 0</li>
<li>systemctl stop firewalld</li>
<li>systemctl disable firewalld</li>
</ul>
<p>####修改hostname<br>执行命令： vi /etc/hostname<br>10.0.0.128 改成 master-k8s<br>10.0.0.129 改成 node2-k8s<br>10.0.0.130 改成 node3-k8s</p>
<p>####修改host文件<br>vi /etc/hosts</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br><span class="line">::1         localhost localhost.localdomain localhost6 localhost6.localdomain6</span><br><span class="line">10.0.0.128  master-k8s</span><br><span class="line">10.0.0.129  node2-k8s</span><br><span class="line">10.0.0.130  node3-k8s</span><br></pre></td></tr></table></figure>

<p>####禁用swap<br>执行命令：</p>
<ul>
<li>swapoff -a</li>
<li>vi /etc/fstab</li>
</ul>
<p>找到下面行在前面加一个 # 注释 swap功能</p>
<p><code>#/dev/mapper/centos-swap swap swap    defaults        0 0    #禁用swap自动挂载</code></p>
<h4 id="安装Docker"><a href="#安装Docker" class="headerlink" title="安装Docker"></a>安装Docker</h4><p>顺序执行命令：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install -y yum-utils device-mapper-persistent-data lvm2</span><br><span class="line">sudo yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo</span><br><span class="line">sudo yum install docker-ce-18.09.1 docker-ce-cli-18.09.1 containerd.io</span><br><span class="line">systemctl start docker.service</span><br><span class="line">systemctl enable docker.service</span><br></pre></td></tr></table></figure>

<p>配置阿里云镜像加速器</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">cat&gt;</span><span class="bash">&gt;/etc/docker/daemon.json&lt;&lt;EOF</span></span><br><span class="line">&#123;</span><br><span class="line">        "registry-mirrors":[ "https://x6stvqqp.mirror.aliyuncs.com" ]</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>

<p>上面执行完后 重启docker生效</p>
<p>执行命令：</p>
<ul>
<li>systemctl daemon-reload</li>
<li>systemctl restart docker</li>
</ul>
<p>添加K8s 国内镜像源</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cat&gt;&gt;&#x2F;etc&#x2F;yum.repos.d&#x2F;kubrenetes.repo&lt;&lt;EOF</span><br><span class="line">[kubernetes]</span><br><span class="line">name&#x3D;Kubernetes Repo</span><br><span class="line">baseurl&#x3D;https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;kubernetes&#x2F;yum&#x2F;repos&#x2F;kubernetes-el7-x86_64&#x2F;</span><br><span class="line">gpgcheck&#x3D;0</span><br><span class="line">gpgkey&#x3D;https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;kubernetes&#x2F;yum&#x2F;doc&#x2F;yum-key.gpg</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>

<h4 id="安装K8s所需要的3个组件"><a href="#安装K8s所需要的3个组件" class="headerlink" title="安装K8s所需要的3个组件"></a>安装K8s所需要的3个组件</h4><p>执行命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y kubeadm-1.18.3  kubelet-1.18.3  kubectl-1.18.3</span><br></pre></td></tr></table></figure>

<p>说明：</p>
<ul>
<li><p>kubeadm：安装工具，使所有的组件都会以容器的方式运行</p>
</li>
<li><p>kubectl：客户端连接K8S API工具</p>
</li>
<li><p>kubelet：运行在node节点，用来启动容器的工具</p>
</li>
</ul>
<h4 id="设置k8s开机自启动"><a href="#设置k8s开机自启动" class="headerlink" title="设置k8s开机自启动"></a>设置k8s开机自启动</h4><p>执行命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl enable kubelet.service</span><br></pre></td></tr></table></figure>
<p>加载内核模块</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cat&gt;&gt;&#x2F;etc&#x2F;sysctl.d&#x2F;k8s.conf &lt;&lt; EOF</span><br><span class="line">net.bridge.bridge-nf-call-ip6tables &#x3D; 1</span><br><span class="line">net.bridge.bridge-nf-call-iptables &#x3D; 1</span><br><span class="line">net.ipv4.ip_nonlocal_bind &#x3D; 1</span><br><span class="line">net.ipv4.ip_forward &#x3D; 1</span><br><span class="line">vm.swappiness&#x3D;0</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>
<p>然后执行</p>
<ul>
<li>vi /etc/sysctl.conf 填写： net.ipv4.ip_forward = 1</li>
<li>执行命令： sysctl -p</li>
</ul>
<p>执行命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">cat &gt; &#x2F;etc&#x2F;sysconfig&#x2F;modules&#x2F;ipvs.modules &lt;&lt;EOF</span><br><span class="line">#!&#x2F;bin&#x2F;bash</span><br><span class="line">modprobe -- br_netfilter</span><br><span class="line">modprobe -- ip_vs</span><br><span class="line">modprobe -- ip_vs_rr</span><br><span class="line">modprobe -- ip_vs_wrr</span><br><span class="line">modprobe -- ip_vs_sh</span><br><span class="line">modprobe -- nf_conntrack_ipv4</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>
<p>执行命令：</p>
<ul>
<li>chmod 755 /etc/sysconfig/modules/ipvs.modules</li>
<li>bash /etc/sysconfig/modules/ipvs.modules</li>
<li>lsmod | grep -E “ip_vs|nf_conntrack_ipv4”</li>
</ul>
<p><strong>* 上面的步骤需要在3台centos虚拟机都得执行的！[end] *</strong> </p>
<p>建议：现在master-k8s上完成配置，然后克隆，修改hostname</p>
<hr>
<h2 id="下面的步骤只在master-k8s-机器上操作"><a href="#下面的步骤只在master-k8s-机器上操作" class="headerlink" title="下面的步骤只在master-k8s 机器上操作"></a>下面的步骤只在master-k8s 机器上操作</h2><p>通过如下指令创建默认的kubeadm-config.yaml文件：</p>
<p>执行命令：</p>
<ul>
<li>kubeadm config print init-defaults &gt; kubeadm-config.yaml</li>
</ul>
<p>然后修改 kubeadm-config.yaml配置</p>
<p>下面有注释的地方就是要修改的地方！</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">[root@docker-server1 ~]# vi kubeadm-config.yaml</span><br><span class="line">apiVersion: kubeadm.k8s.io&#x2F;v1beta2</span><br><span class="line">bootstrapTokens:</span><br><span class="line">- groups:</span><br><span class="line">  - system:bootstrappers:kubeadm:default-node-token</span><br><span class="line">  token: abcdef.0123456789abcdef</span><br><span class="line">  ttl: 24h0m0s</span><br><span class="line">  usages:</span><br><span class="line">  - signing</span><br><span class="line">  - authentication</span><br><span class="line">kind: InitConfiguration</span><br><span class="line">localAPIEndpoint:</span><br><span class="line">  advertiseAddress: 10.0.0.128  #master节点的IP</span><br><span class="line">  bindPort: 6443</span><br><span class="line">nodeRegistration:</span><br><span class="line">  criSocket: &#x2F;var&#x2F;run&#x2F;dockershim.sock</span><br><span class="line">  name: 10.0.0.128                       #修改为IP地址，如果使用域名，必须保证解析正常</span><br><span class="line">  taints:</span><br><span class="line">  - effect: NoSchedule</span><br><span class="line">    key: node-role.kubernetes.io&#x2F;master</span><br><span class="line">---</span><br><span class="line">apiServer:</span><br><span class="line">  timeoutForControlPlane: 4m0s</span><br><span class="line">apiVersion: kubeadm.k8s.io&#x2F;v1beta2</span><br><span class="line">certificatesDir: &#x2F;etc&#x2F;kubernetes&#x2F;pki</span><br><span class="line">clusterName: kubernetes</span><br><span class="line">controllerManager: &#123;&#125;</span><br><span class="line">dns:</span><br><span class="line">  type: CoreDNS</span><br><span class="line">etcd:</span><br><span class="line">  local:</span><br><span class="line">    dataDir: &#x2F;var&#x2F;lib&#x2F;etcd                       #把etcd容器的目录挂载到本地的&#x2F;var&#x2F;lib&#x2F;etcd目录下，防止数据丢失</span><br><span class="line">imageRepository: registry.cn-hangzhou.aliyuncs.com&#x2F;google_containers          #镜像仓库地址</span><br><span class="line">kind: ClusterConfiguration</span><br><span class="line">kubernetesVersion: v1.18.3                     #Kubernetes软件版本</span><br><span class="line">networking:</span><br><span class="line">  dnsDomain: cluster.local</span><br><span class="line">  serviceSubnet: 10.96.0.0&#x2F;12</span><br><span class="line">  podSubnet: 10.244.0.0&#x2F;16        #添加这个内容</span><br><span class="line">scheduler: &#123;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="预先下载镜像"><a href="#预先下载镜像" class="headerlink" title="预先下载镜像"></a>预先下载镜像</h4><p>执行命令：</p>
<ul>
<li>kubeadm config images pull –config kubeadm-config.yaml</li>
</ul>
<p>执行命令：</p>
<ul>
<li>echo ‘1’ &gt; /proc/sys/net/bridge/bridge-nf-call-iptables</li>
</ul>
<h4 id="安装matser节点"><a href="#安装matser节点" class="headerlink" title="安装matser节点"></a>安装matser节点</h4><p>执行命令：</p>
<ul>
<li>kubeadm init –config kubeadm-config.yaml</li>
</ul>
<p>如果输出以下信息表示，swap没有被禁用</p>
<ul>
<li>[ERROR Swap]: running with swap on is not supported. Please disable swap</li>
<li>输出以下信息表示，请执行echo ‘1’ &gt; /proc/sys/net/bridge/bridge-nf-call-iptables</li>
</ul>
<p>[ERROR FileContent–proc-sys-net-bridge-bridge-nf-call-iptables]: /proc/sys/net/bridge/bridge-nf-call-iptables contents are not set to 1</p>
<p>安装成功后注意看console上运行的信息</p>
<p>执行命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p $HOME&#x2F;.kube</span><br><span class="line">sudo cp -i &#x2F;etc&#x2F;kubernetes&#x2F;admin.conf $HOME&#x2F;.kube&#x2F;config</span><br><span class="line">sudo chown $(id -u):$(id -g) $HOME&#x2F;.kube&#x2F;config</span><br></pre></td></tr></table></figure>
<h4 id="在master-k8s获取token、cert-hash"><a href="#在master-k8s获取token、cert-hash" class="headerlink" title="在master-k8s获取token、cert-hash"></a>在master-k8s获取token、cert-hash</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@master-k8s]# kubeadm  token create</span><br><span class="line">kiyfhw.xiacqbch8o8fa8qj</span><br><span class="line"></span><br><span class="line">[root@node1 flannel]# kubeadm  token list</span><br><span class="line">TOKEN                     TTL         EXPIRES                     USAGES                   DESCRIPTION   EXTRA GROUPS</span><br><span class="line">abcdef.0123456789abcdef   &lt;invalid&gt;   2020-06-10T14:16:06+08:00   authentication,signing   &lt;none&gt;        system:bootstrappers:kubeadm:default-node-token</span><br><span class="line">kiyfhw.xiacqbch8o8fa8qj   23h         2020-06-10T06:39:24+08:00   authentication,signing   &lt;none&gt;        system:bootstrappers:kubeadm:default-node-token</span><br><span class="line"></span><br><span class="line"># 生成ca的sha256 hash值</span><br><span class="line">[root@master-k8s]# openssl x509 -pubkey -in &#x2F;etc&#x2F;kubernetes&#x2F;pki&#x2F;ca.crt | openssl rsa -pubin -outform der 2&gt;&#x2F;dev&#x2F;null | openssl dgst -sha256 -hex | sed &#39;s&#x2F;^.* &#x2F;&#x2F;&#39;</span><br><span class="line">5417eb1b68bd4e7a4c82aded83abc55ec91bd601e45734d6aba85de8b1ebb057</span><br></pre></td></tr></table></figure>

<h4 id="kubeadm-join"><a href="#kubeadm-join" class="headerlink" title="kubeadm join"></a>kubeadm join</h4><p>把下面的命令拿到 10.0.0.129/10.0.0.130 工作节点虚拟机上运行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubeadm join 10.0.0.128:6443 --token kiyfhw.xiacqbch8o8fa8qj   --discovery-token-ca-cert-hash sha256:5417eb1b68bd4e7a4c82aded83abc55ec91bd601e45734d6aba85de8b1ebb057</span><br></pre></td></tr></table></figure>
<p>若果有失败提示<br>在node节点上配置信息</p>
<ul>
<li>vi /etc/docker/daemon.json</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">        <span class="attr">"registry-mirrors"</span>:[ <span class="string">"https://x6stvqqp.mirror.aliyuncs.com"</span> ],</span><br><span class="line">		<span class="attr">"exec-opts"</span>:[<span class="string">"native.cgroupdriver=systemmd"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>以上运行成功 检测下</p>
<p>在master-k8s执行命令</p>
<ul>
<li>sudo kubectl get nodes</li>
</ul>
<p>你会发现 Status 是 NotReady，因为没有安装网络插件！</p>
<h4 id="安装网络插件flannel"><a href="#安装网络插件flannel" class="headerlink" title="安装网络插件flannel"></a>安装网络插件flannel</h4><p>因为上面我们安装的的k8s的版本是 v 1.18.3</p>
<p>这个版本对应的 flannel 版本是：v0.12.0</p>
<p>因为由于某种不可抗力 一定得先下载好docker镜像！</p>
<ul>
<li>docker pull quay-mirror.qiniu.com/coreos/flannel:v0.12.0-amd64</li>
</ul>
<p>下载 flannel 的 yml文件：</p>
<ul>
<li>wget <a href="https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml" target="_blank" rel="noopener">https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml</a></li>
</ul>
<p>执行命令：</p>
<ul>
<li>kubectl apply -f kube-flannel.yml</li>
</ul>
<p>等待k8s 把 pod：flannel生效 可以用命令查看状态进度：</p>
<ul>
<li>kubectl get pods -n kube-system</li>
</ul>
<p>等 flannel 状态显示 Running后</p>
<p>执行查看k8s集群运行状态命令：</p>
<ul>
<li>kubectl get nodes</li>
</ul>
<table>
<thead>
<tr>
<th>NAME</th>
<th>STATUS</th>
<th>ROLES</th>
<th>AGE</th>
<th>VERSION</th>
</tr>
</thead>
<tbody><tr>
<td>10.0.0.128</td>
<td>Ready</td>
<td>master</td>
<td>30m</td>
<td>v1.18.3</td>
</tr>
<tr>
<td>node2-k8s</td>
<td>NotReady</td>
<td><none></td>
<td>50m</td>
<td>v1.18.3</td>
</tr>
<tr>
<td>node3-k8s</td>
<td>NotReady</td>
<td><none></td>
<td>51m</td>
<td>v1.18.3</td>
</tr>
</tbody></table>
<p>发现master已经Ready了 但是工作node没有起来，状态是NotReady</p>
<p>下面去配置工作node虚拟机上的flannel配置</p>
<p>10.0.0.129 是我的工作node2-k8s</p>
<h4 id="运行命令把master节点的配置copy到工作节点"><a href="#运行命令把master节点的配置copy到工作节点" class="headerlink" title="运行命令把master节点的配置copy到工作节点"></a>运行命令把master节点的配置copy到工作节点</h4><ul>
<li>scp -r 10.0.0.128:/etc/cni /etc/cni</li>
</ul>
<p>重启启动 kubelet</p>
<ul>
<li>systemctl restart kubelet</li>
</ul>
<p>回到master节点查看</p>
<p>执行查看k8s集群运行状态命令：</p>
<ul>
<li>kubectl get nodes</li>
</ul>
<table>
<thead>
<tr>
<th>NAME</th>
<th>STATUS</th>
<th>ROLES</th>
<th>AGE</th>
<th>VERSION</th>
</tr>
</thead>
<tbody><tr>
<td>10.0.0.128</td>
<td>Ready</td>
<td>master</td>
<td>30m</td>
<td>v1.18.3</td>
</tr>
<tr>
<td>node2-k8s</td>
<td>Ready</td>
<td><none></td>
<td>55m</td>
<td>v1.18.3</td>
</tr>
<tr>
<td>node3-k8s</td>
<td>Ready</td>
<td><none></td>
<td>56m</td>
<td>v1.18.3</td>
</tr>
</tbody></table>
<ul>
<li>kubectl get pods -n kube-system</li>
</ul>
<p>发现 有两个flannel 容器没有起来，那么在node2-k8s，node3-k8s检查是否有如下信息,没有就添加。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;run&#x2F;flannel&#x2F;subnet.env</span><br><span class="line">FLANNEL_NETWORK&#x3D;10.244.0.0&#x2F;16</span><br><span class="line">FLANNEL_SUBNET&#x3D;10.244.1.1&#x2F;24</span><br><span class="line">FLANNEL_MTU&#x3D;1450</span><br><span class="line">FLANNEL_IPMASQ&#x3D;true</span><br></pre></td></tr></table></figure>

<h2 id="安装Dashboard-UI-v2-0-1"><a href="#安装Dashboard-UI-v2-0-1" class="headerlink" title="安装Dashboard UI v2.0.1"></a>安装Dashboard UI v2.0.1</h2><p>参考地址：</p>
<p>部署文件 Github 地址：<a href="https://github.com/my-dlq/blog-example/tree/master/kubernetes/kubernetes-dashboard2.0.0-deploy" target="_blank" rel="noopener">https://github.com/my-dlq/blog-example/tree/master/kubernetes/kubernetes-dashboard2.0.0-deploy</a></p>
<p>###1、Dashboard RBAC</p>
<p>创建 Dashboard RBAC 部署文件</p>
<p>k8s-dashboard-rbac.yaml</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">apiVersion:</span> v1</span><br><span class="line"><span class="string">kind:</span> ServiceAccount</span><br><span class="line"><span class="string">metadata:</span></span><br><span class="line"><span class="symbol">  labels:</span></span><br><span class="line">    k8s-<span class="string">app:</span> kubernetes-dashboard</span><br><span class="line"><span class="symbol">  name:</span> kubernetes-dashboard</span><br><span class="line"><span class="symbol">  namespace:</span> kube-system</span><br><span class="line">---</span><br><span class="line"><span class="string">apiVersion:</span> rbac.authorization.k8s.io/v1</span><br><span class="line"><span class="string">kind:</span> Role</span><br><span class="line"><span class="string">metadata:</span></span><br><span class="line"><span class="symbol">  labels:</span></span><br><span class="line">    k8s-<span class="string">app:</span> kubernetes-dashboard</span><br><span class="line"><span class="symbol">  name:</span> kubernetes-dashboard</span><br><span class="line"><span class="symbol">  namespace:</span> kube-system</span><br><span class="line"><span class="string">rules:</span></span><br><span class="line">  - <span class="string">apiGroups:</span> [<span class="string">""</span>]</span><br><span class="line"><span class="symbol">    resources:</span> [<span class="string">"secrets"</span>]</span><br><span class="line"><span class="symbol">    resourceNames:</span> [<span class="string">"kubernetes-dashboard-key-holder"</span>, <span class="string">"kubernetes-dashboard-certs"</span>, <span class="string">"kubernetes-dashboard-csrf"</span>]</span><br><span class="line"><span class="symbol">    verbs:</span> [<span class="string">"get"</span>, <span class="string">"update"</span>, <span class="string">"delete"</span>]</span><br><span class="line">  - <span class="string">apiGroups:</span> [<span class="string">""</span>]</span><br><span class="line"><span class="symbol">    resources:</span> [<span class="string">"configmaps"</span>]</span><br><span class="line"><span class="symbol">    resourceNames:</span> [<span class="string">"kubernetes-dashboard-settings"</span>]</span><br><span class="line"><span class="symbol">    verbs:</span> [<span class="string">"get"</span>, <span class="string">"update"</span>]</span><br><span class="line">  - <span class="string">apiGroups:</span> [<span class="string">""</span>]</span><br><span class="line"><span class="symbol">    resources:</span> [<span class="string">"services"</span>]</span><br><span class="line"><span class="symbol">    resourceNames:</span> [<span class="string">"heapster"</span>, <span class="string">"dashboard-metrics-scraper"</span>]</span><br><span class="line"><span class="symbol">    verbs:</span> [<span class="string">"proxy"</span>]</span><br><span class="line">  - <span class="string">apiGroups:</span> [<span class="string">""</span>]</span><br><span class="line"><span class="symbol">    resources:</span> [<span class="string">"services/proxy"</span>]</span><br><span class="line"><span class="symbol">    resourceNames:</span> [<span class="string">"heapster"</span>, <span class="string">"http:heapster:"</span>, <span class="string">"https:heapster:"</span>, <span class="string">"dashboard-metrics-scraper"</span>, <span class="string">"http:dashboard-metrics-scraper"</span>]</span><br><span class="line"><span class="symbol">    verbs:</span> [<span class="string">"get"</span>]</span><br><span class="line">---</span><br><span class="line"><span class="string">apiVersion:</span> rbac.authorization.k8s.io/v1</span><br><span class="line"><span class="string">kind:</span> ClusterRole</span><br><span class="line"><span class="string">metadata:</span></span><br><span class="line"><span class="symbol">  labels:</span></span><br><span class="line">    k8s-<span class="string">app:</span> kubernetes-dashboard</span><br><span class="line"><span class="symbol">  name:</span> kubernetes-dashboard</span><br><span class="line"><span class="string">rules:</span></span><br><span class="line">  - <span class="string">apiGroups:</span> [<span class="string">"metrics.k8s.io"</span>]</span><br><span class="line"><span class="symbol">    resources:</span> [<span class="string">"pods"</span>, <span class="string">"nodes"</span>]</span><br><span class="line"><span class="symbol">    verbs:</span> [<span class="string">"get"</span>, <span class="string">"list"</span>, <span class="string">"watch"</span>]</span><br><span class="line">---</span><br><span class="line"><span class="string">apiVersion:</span> rbac.authorization.k8s.io/v1</span><br><span class="line"><span class="string">kind:</span> RoleBinding</span><br><span class="line"><span class="string">metadata:</span></span><br><span class="line"><span class="symbol">  labels:</span></span><br><span class="line">    k8s-<span class="string">app:</span> kubernetes-dashboard</span><br><span class="line"><span class="symbol">  name:</span> kubernetes-dashboard</span><br><span class="line"><span class="symbol">  namespace:</span> kube-system</span><br><span class="line"><span class="string">roleRef:</span></span><br><span class="line"><span class="symbol">  apiGroup:</span> rbac.authorization.k8s.io</span><br><span class="line"><span class="symbol">  kind:</span> Role</span><br><span class="line"><span class="symbol">  name:</span> kubernetes-dashboard</span><br><span class="line"><span class="string">subjects:</span></span><br><span class="line">  - <span class="string">kind:</span> ServiceAccount</span><br><span class="line"><span class="symbol">    name:</span> kubernetes-dashboard</span><br><span class="line"><span class="symbol">    namespace:</span> kube-system</span><br><span class="line">---</span><br><span class="line"><span class="string">apiVersion:</span> rbac.authorization.k8s.io/v1</span><br><span class="line"><span class="string">kind:</span> ClusterRoleBinding</span><br><span class="line"><span class="string">metadata:</span></span><br><span class="line"><span class="symbol">  name:</span> kubernetes-dashboard</span><br><span class="line"><span class="symbol">  namespace:</span> kube-system</span><br><span class="line"><span class="string">roleRef:</span></span><br><span class="line"><span class="symbol">  apiGroup:</span> rbac.authorization.k8s.io</span><br><span class="line"><span class="symbol">  kind:</span> ClusterRole</span><br><span class="line"><span class="symbol">  name:</span> kubernetes-dashboard</span><br><span class="line"><span class="string">subjects:</span></span><br><span class="line">  - <span class="string">kind:</span> ServiceAccount</span><br><span class="line"><span class="symbol">    name:</span> kubernetes-dashboard</span><br><span class="line"><span class="symbol">    namespace:</span> kube-system</span><br></pre></td></tr></table></figure>

<p>部署 Dashboard RBAC</p>
<ul>
<li>kubectl apply -f k8s-dashboard-rbac.yaml</li>
</ul>
<h3 id="创建-ConfigMap、Secret"><a href="#创建-ConfigMap、Secret" class="headerlink" title="创建 ConfigMap、Secret"></a>创建 ConfigMap、Secret</h3><p>创建 Dashboard Config &amp; Secret 部署文件</p>
<p>k8s-dashboard-configmap-secret.yaml</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">apiVersion:</span> v1</span><br><span class="line"><span class="string">kind:</span> Secret</span><br><span class="line"><span class="string">metadata:</span></span><br><span class="line"><span class="symbol">  labels:</span></span><br><span class="line">    k8s-<span class="string">app:</span> kubernetes-dashboard</span><br><span class="line"><span class="symbol">  name:</span> kubernetes-dashboard-certs</span><br><span class="line"><span class="symbol">  namespace:</span> kube-system</span><br><span class="line"><span class="string">type:</span> Opaque</span><br><span class="line">---</span><br><span class="line"><span class="string">apiVersion:</span> v1</span><br><span class="line"><span class="string">kind:</span> Secret</span><br><span class="line"><span class="string">metadata:</span></span><br><span class="line"><span class="symbol">  labels:</span></span><br><span class="line">    k8s-<span class="string">app:</span> kubernetes-dashboard</span><br><span class="line"><span class="symbol">  name:</span> kubernetes-dashboard-csrf</span><br><span class="line"><span class="symbol">  namespace:</span> kube-system</span><br><span class="line"><span class="string">type:</span> Opaque</span><br><span class="line"><span class="string">data:</span></span><br><span class="line"><span class="symbol">  csrf:</span> <span class="string">""</span></span><br><span class="line">---</span><br><span class="line"><span class="string">apiVersion:</span> v1</span><br><span class="line"><span class="string">kind:</span> Secret</span><br><span class="line"><span class="string">metadata:</span></span><br><span class="line"><span class="symbol">  labels:</span></span><br><span class="line">    k8s-<span class="string">app:</span> kubernetes-dashboard</span><br><span class="line"><span class="symbol">  name:</span> kubernetes-dashboard-key-holder</span><br><span class="line"><span class="symbol">  namespace:</span> kube-system</span><br><span class="line"><span class="string">type:</span> Opaque</span><br><span class="line">---</span><br><span class="line"><span class="string">kind:</span> ConfigMap</span><br><span class="line"><span class="string">apiVersion:</span> v1</span><br><span class="line"><span class="string">metadata:</span></span><br><span class="line"><span class="symbol">  labels:</span></span><br><span class="line">    k8s-<span class="string">app:</span> kubernetes-dashboard</span><br><span class="line"><span class="symbol">  name:</span> kubernetes-dashboard-settings</span><br><span class="line"><span class="symbol">  namespace:</span> kube-system</span><br></pre></td></tr></table></figure>

<p>部署 Dashboard Config &amp; Secret</p>
<ul>
<li>kubectl apply -f k8s-dashboard-configmap-secret.yaml</li>
</ul>
<h3 id="kubernetes-dashboard"><a href="#kubernetes-dashboard" class="headerlink" title="kubernetes-dashboard"></a>kubernetes-dashboard</h3><p>创建 Dashboard Deploy 部署文件<br>k8s-dashboard-deploy.yaml</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">kind: Service</span><br><span class="line">apiVersion: v1</span><br><span class="line">metadata:</span><br><span class="line">  labels:</span><br><span class="line">    k8s-app: kubernetes-dashboard</span><br><span class="line">  name: kubernetes-dashboard</span><br><span class="line">  namespace: kube-system</span><br><span class="line">spec:</span><br><span class="line">  type: NodePort</span><br><span class="line">  ports:</span><br><span class="line">    - port: 443</span><br><span class="line">      nodePort: 30001</span><br><span class="line">      targetPort: 8443</span><br><span class="line">  selector:</span><br><span class="line">    k8s-app: kubernetes-dashboard</span><br><span class="line">---</span><br><span class="line">## Dashboard Deployment</span><br><span class="line">kind: Deployment</span><br><span class="line">apiVersion: apps&#x2F;v1</span><br><span class="line">metadata:</span><br><span class="line">  labels:</span><br><span class="line">    k8s-app: kubernetes-dashboard</span><br><span class="line">  name: kubernetes-dashboard</span><br><span class="line">  namespace: kube-system</span><br><span class="line">spec:</span><br><span class="line">  replicas: 1</span><br><span class="line">  revisionHistoryLimit: 10</span><br><span class="line">  selector:</span><br><span class="line">    matchLabels:</span><br><span class="line">      k8s-app: kubernetes-dashboard</span><br><span class="line">  template:</span><br><span class="line">    metadata:</span><br><span class="line">      labels:</span><br><span class="line">        k8s-app: kubernetes-dashboard</span><br><span class="line">    spec:</span><br><span class="line">      serviceAccountName: kubernetes-dashboard</span><br><span class="line">      containers:</span><br><span class="line">        - name: kubernetes-dashboard</span><br><span class="line">          image: kubernetesui&#x2F;dashboard:v2.0.1</span><br><span class="line">          securityContext:</span><br><span class="line">            allowPrivilegeEscalation: false</span><br><span class="line">            readOnlyRootFilesystem: true</span><br><span class="line">            runAsUser: 1001</span><br><span class="line">            runAsGroup: 2001</span><br><span class="line">          ports:</span><br><span class="line">            - containerPort: 8443</span><br><span class="line">              protocol: TCP</span><br><span class="line">          args:</span><br><span class="line">            - --auto-generate-certificates</span><br><span class="line">            - --namespace&#x3D;kube-system          #设置为当前部署的Namespace</span><br><span class="line">          resources:</span><br><span class="line">            limits:</span><br><span class="line">              cpu: 1000m</span><br><span class="line">              memory: 512Mi</span><br><span class="line">            requests:</span><br><span class="line">              cpu: 1000m</span><br><span class="line">              memory: 512Mi</span><br><span class="line">          livenessProbe:</span><br><span class="line">            httpGet:</span><br><span class="line">              scheme: HTTPS</span><br><span class="line">              path: &#x2F;</span><br><span class="line">              port: 8443</span><br><span class="line">            initialDelaySeconds: 30</span><br><span class="line">            timeoutSeconds: 30</span><br><span class="line">          volumeMounts:</span><br><span class="line">            - name: kubernetes-dashboard-certs</span><br><span class="line">              mountPath: &#x2F;certs</span><br><span class="line">            - name: tmp-volume</span><br><span class="line">              mountPath: &#x2F;tmp</span><br><span class="line">            - name: localtime</span><br><span class="line">              readOnly: true</span><br><span class="line">              mountPath: &#x2F;etc&#x2F;localtime</span><br><span class="line">      volumes:</span><br><span class="line">        - name: kubernetes-dashboard-certs</span><br><span class="line">          secret:</span><br><span class="line">            secretName: kubernetes-dashboard-certs</span><br><span class="line">        - name: tmp-volume</span><br><span class="line">          emptyDir: &#123;&#125;</span><br><span class="line">        - name: localtime</span><br><span class="line">          hostPath:</span><br><span class="line">            type: File</span><br><span class="line">            path: &#x2F;etc&#x2F;localtime</span><br><span class="line">      tolerations:</span><br><span class="line">        - key: node-role.kubernetes.io&#x2F;master</span><br><span class="line">          effect: NoSchedule</span><br></pre></td></tr></table></figure>

<p>部署 Dashboard Deploy</p>
<ul>
<li>kubectl apply -f k8s-dashboard-deploy.yaml</li>
</ul>
<h3 id="创建-kubernetes-metrics-scraper"><a href="#创建-kubernetes-metrics-scraper" class="headerlink" title="创建 kubernetes-metrics-scraper"></a>创建 kubernetes-metrics-scraper</h3><p>创建 Dashboard Metrics 部署文件</p>
<p>k8s-dashboard-metrics.yaml</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">kind: Service</span><br><span class="line">apiVersion: v1</span><br><span class="line">metadata:</span><br><span class="line">  labels:</span><br><span class="line">    k8s-app: dashboard-metrics-scraper</span><br><span class="line">  name: dashboard-metrics-scraper</span><br><span class="line">  namespace: kube-system</span><br><span class="line">spec:</span><br><span class="line">  ports:</span><br><span class="line">    - port: 8000</span><br><span class="line">      targetPort: 8000</span><br><span class="line">  selector:</span><br><span class="line">    k8s-app: dashboard-metrics-scraper</span><br><span class="line">---</span><br><span class="line">## Dashboard Metrics Deployment</span><br><span class="line">kind: Deployment</span><br><span class="line">apiVersion: apps&#x2F;v1</span><br><span class="line">metadata:</span><br><span class="line">  labels:</span><br><span class="line">    k8s-app: dashboard-metrics-scraper</span><br><span class="line">  name: dashboard-metrics-scraper</span><br><span class="line">  namespace: kube-system</span><br><span class="line">spec:</span><br><span class="line">  replicas: 1</span><br><span class="line">  revisionHistoryLimit: 10</span><br><span class="line">  selector:</span><br><span class="line">    matchLabels:</span><br><span class="line">      k8s-app: dashboard-metrics-scraper</span><br><span class="line">  template:</span><br><span class="line">    metadata:</span><br><span class="line">      labels:</span><br><span class="line">        k8s-app: dashboard-metrics-scraper</span><br><span class="line">      annotations:</span><br><span class="line">        seccomp.security.alpha.kubernetes.io&#x2F;pod: &#39;runtime&#x2F;default&#39;</span><br><span class="line">    spec:</span><br><span class="line">      serviceAccountName: kubernetes-dashboard</span><br><span class="line">      containers:</span><br><span class="line">        - name: dashboard-metrics-scraper</span><br><span class="line">          image: kubernetesui&#x2F;metrics-scraper:v1.0.4</span><br><span class="line">          securityContext:</span><br><span class="line">            allowPrivilegeEscalation: false</span><br><span class="line">            readOnlyRootFilesystem: true</span><br><span class="line">            runAsUser: 1001</span><br><span class="line">            runAsGroup: 2001</span><br><span class="line">          ports:</span><br><span class="line">            - containerPort: 8000</span><br><span class="line">              protocol: TCP</span><br><span class="line">          resources:</span><br><span class="line">            limits:</span><br><span class="line">              cpu: 1000m</span><br><span class="line">              memory: 512Mi</span><br><span class="line">            requests:</span><br><span class="line">              cpu: 1000m</span><br><span class="line">              memory: 512Mi</span><br><span class="line">          livenessProbe:</span><br><span class="line">            httpGet:</span><br><span class="line">              scheme: HTTP</span><br><span class="line">              path: &#x2F;</span><br><span class="line">              port: 8000</span><br><span class="line">            initialDelaySeconds: 30</span><br><span class="line">            timeoutSeconds: 30</span><br><span class="line">          volumeMounts:</span><br><span class="line">          - mountPath: &#x2F;tmp</span><br><span class="line">            name: tmp-volume</span><br><span class="line">          - name: localtime</span><br><span class="line">            readOnly: true</span><br><span class="line">            mountPath: &#x2F;etc&#x2F;localtime</span><br><span class="line">      volumes:</span><br><span class="line">        - name: tmp-volume</span><br><span class="line">          emptyDir: &#123;&#125;</span><br><span class="line">        - name: localtime</span><br><span class="line">          hostPath:</span><br><span class="line">            type: File</span><br><span class="line">            path: &#x2F;etc&#x2F;localtime</span><br><span class="line">      nodeSelector:</span><br><span class="line">        &quot;beta.kubernetes.io&#x2F;os&quot;: linux</span><br><span class="line">      tolerations:</span><br><span class="line">        - key: node-role.kubernetes.io&#x2F;master</span><br><span class="line">          effect: NoSchedule</span><br></pre></td></tr></table></figure>
<p>部署 Dashboard Metrics</p>
<ul>
<li>kubectl apply -f k8s-dashboard-metrics.yaml</li>
</ul>
<h3 id="创建访问的-ServiceAccount"><a href="#创建访问的-ServiceAccount" class="headerlink" title="创建访问的 ServiceAccount"></a>创建访问的 ServiceAccount</h3><p>创建一个绑定 admin 权限的 ServiceAccount，获取其 Token 用于访问看板。</p>
<p>创建 Dashboard ServiceAccount 部署文件</p>
<p>k8s-dashboard-token.yaml</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">kind: ClusterRoleBinding</span><br><span class="line">apiVersion: rbac.authorization.k8s.io&#x2F;v1</span><br><span class="line">metadata:</span><br><span class="line">  name: admin</span><br><span class="line">  annotations:</span><br><span class="line">    rbac.authorization.kubernetes.io&#x2F;autoupdate: &quot;true&quot;</span><br><span class="line">roleRef:</span><br><span class="line">  kind: ClusterRole</span><br><span class="line">  name: cluster-admin</span><br><span class="line">  apiGroup: rbac.authorization.k8s.io</span><br><span class="line">subjects:</span><br><span class="line">- kind: ServiceAccount</span><br><span class="line">  name: admin</span><br><span class="line">  namespace: kube-system</span><br><span class="line">---</span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: ServiceAccount</span><br><span class="line">metadata:</span><br><span class="line">  name: admin</span><br><span class="line">  namespace: kube-system</span><br><span class="line">  labels:</span><br><span class="line">    kubernetes.io&#x2F;cluster-service: &quot;true&quot;</span><br><span class="line">    addonmanager.kubernetes.io&#x2F;mode: Reconcile</span><br></pre></td></tr></table></figure>

<p>部署访问的 ServiceAccount</p>
<ul>
<li>kubectl apply -f k8s-dashboard-token.yaml</li>
</ul>
<h4 id="获取-Token"><a href="#获取-Token" class="headerlink" title="获取 Token"></a>获取 Token</h4><ul>
<li>kubectl describe secret/$(kubectl get secret -n kube-system |grep admin|awk ‘{print $1}’) -n kube-system</li>
</ul>
<p>token：</p>
<p>xxxxxxxx.xxxxxxx.xxxxxx</p>
<h4 id="登录"><a href="#登录" class="headerlink" title="登录"></a>登录</h4><p><a href="https://10.0.0.128:30001" target="_blank" rel="noopener">https://10.0.0.128:30001</a> </p>

      
    </div>
    <div class="article-footer">
      <blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    
    <li class="post-copyright-link hidden-xs">
      <strong>本文链接：</strong>
      <a href="http://btbib.com/2020-06-17-1.html" title="VMware搭建最新k8s集群v1.18.3" target="_blank" rel="external">http://btbib.com/2020-06-17-1.html</a>
    </li>
    
    <li class="post-copyright-license">
      <strong>版权声明： </strong> 本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！
    </li>
  </ul>
</blockquote>


<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="/images/avatar.jpg" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="" target="_blank"><span class="text-dark">比特笔</span><small class="ml-1x">上古码农</small></a></h3>
        <div>上古码农，统治六界，降妖除魔，国泰民安，建房种树，喝茶聊码。</div>
      </div>
    </figure>
  </div>
</div>


    </div>
  </article>
  
    
  <section id="comments">
  	
  </section>


  
</div>

  <nav class="bar bar-footer clearfix" data-stick-bottom>
  <div class="bar-inner">
  
  <ul class="pager pull-left">
    
    
    <li class="next">
      <a href="/2020-05-11-1.html" title="技术Leader的30条军规"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a>
    </li>
    
    
  </ul>
  
  
  <!-- Button trigger modal -->
  <button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>赏</span></button>
  <!-- <div class="wave-icon wave-icon-danger btn-donate" data-toggle="modal" data-target="#donateModal">
    <div class="wave-circle"><span class="icon"><i class="icon icon-bill"></i></span></div>
  </div> -->
  
  
  <div class="bar-right">
    
    <div class="share-component" data-sites="weibo,qq,wechat,facebook,twitter" data-mobile-sites="weibo,qq,qzone"></div>
    
  </div>
  </div>
</nav>
  
<!-- Modal -->
<div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content donate">
      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
      <div class="modal-body">
        <div class="donate-box">
          <div class="donate-head">
            <p>感谢您的支持，我会继续努力的!</p>
          </div>
          <div class="tab-content">

            <div role="tabpanel" class="tab-pane fade active in" id="wechatpay">
              <div class="donate-payimg">
                <img src="/images/donate/wechatpay.png" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">扫码打赏，你说多少就多少</p>
              <p class="text-grey">打开微信扫一扫，即可进行扫码打赏哦</p>
            </div>

            <div role="tabpanel" class="tab-pane fade" id="alipay">
              <div class="donate-payimg">
                <img src="/images/donate/alipay.png" alt="扫码支持" title="扫一扫" />
              </div>
              <p class="text-muted mv">扫码打赏，你说多少就多少</p>
              <p class="text-grey">打开支付宝扫一扫，即可进行扫码打赏哦</p>
            </div>
            
          </div>
          <div class="donate-footer">
            <ul class="nav nav-tabs nav-justified" role="tablist">
              <li role="presentation" class="active">
                <a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="false"><i class="icon icon-wepay"></i> 微信支付</a>
              </li>
              <li role="presentation" class="">
                <a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="true"><i class="icon icon-alipay"></i> 支付宝</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>



</main>

  <footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
	
	
    <ul class="social-links">
    	
        <li><a href="/atom.xml" target="_blank" title="Rss" data-toggle=tooltip data-placement=top><i class="icon icon-rss"></i></a></li>
        
    </ul>

    <div class="copyright">
    	
        <div class="publishby">
        	<a href="http://beian.miit.gov.cn/" target="_blank"> 渝ICP备20002247号  </a>
        </div>
    </div>
</footer>
  <script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script>
window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>

<script src="/js/plugin.min.js"></script>


<script src="/js/application.js"></script>


    <script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>






   




   






</body>
</html>